----------------------------
Tagged File Container (TFC)
File specification
----------------------------

root {

    section header plaintext {
        field    32    uint      magic_number := 0xE621126E
        field    32    uint      file_version := 0x1
        field    256   stream    encrypted_dek
    }

    section tag_table encrypted => header::encrypted_dek {
        field    32    uint      next_nonce
        field    32    uint      tag_count

        section tag [] {
            field    32              uint      nonce
            field    32              uint      name_length
            field    name_length     string    name
        }

    }

    section blob_table encrypted => header::encrypted_dek {
        field    32     uint   next_nonce
        field    32     uint   blob_count

        section blob_header[] {
            field    32     uint       nonce
            field    256    stream     sha256_hash
            field    64     uint       start_pos
            field    32     uint       tag_count

            section tag_reference [] {
                field    32     uint    index => root::tags::tag::index
            }
        }
    }

    section blobs encrypted => header::encrypted_dek {

        section file [] {
            field    64             uint       data_length
            field    data_length    stream     data
        }

    }

}

